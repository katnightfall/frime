var tt=Object.defineProperty;var nt=(e,t,n)=>t in e?tt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var xe=(e,t,n)=>(nt(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function he(){}function Qe(e){return e()}function je(){return Object.create(null)}function Q(e){e.forEach(Qe)}function $e(e){return typeof e=="function"}function lt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let Ce;function Fe(e,t){return e===t?!0:(Ce||(Ce=document.createElement("a")),Ce.href=t,e===Ce.href)}function st(e){return Object.keys(e).length===0}function r(e,t){e.appendChild(t)}function J(e,t,n){e.insertBefore(t,n||null)}function W(e){e.parentNode&&e.parentNode.removeChild(e)}function it(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function O(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function D(e){return document.createTextNode(e)}function k(){return D(" ")}function at(){return D("")}function C(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function Se(e){return function(t){return t.preventDefault(),e.call(this,t)}}function l(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ot(e){return e===""?null:+e}function rt(e){return Array.from(e.childNodes)}function T(e,t){t=""+t,e.data!==t&&(e.data=t)}function Be(e,t){e.value=t??""}function V(e,t,n,s){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,s?"important":"")}let He;function pe(e){He=e}const re=[],Ee=[];let ce=[];const Ke=[],ct=Promise.resolve();let Ue=!1;function ut(){Ue||(Ue=!0,ct.then(et))}function Pe(e){ce.push(e)}const De=new Set;let oe=0;function et(){if(oe!==0)return;const e=He;do{try{for(;oe<re.length;){const t=re[oe];oe++,pe(t),dt(t.$$)}}catch(t){throw re.length=0,oe=0,t}for(pe(null),re.length=0,oe=0;Ee.length;)Ee.pop()();for(let t=0;t<ce.length;t+=1){const n=ce[t];De.has(n)||(De.add(n),n())}ce.length=0}while(re.length);for(;Ke.length;)Ke.pop()();Ue=!1,De.clear(),pe(e)}function dt(e){if(e.fragment!==null){e.update(),Q(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Pe)}}function ft(e){const t=[],n=[];ce.forEach(s=>e.indexOf(s)===-1?t.push(s):n.push(s)),n.forEach(s=>s()),ce=t}const gt=new Set;function pt(e,t){e&&e.i&&(gt.delete(e),e.i(t))}function Ye(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ht(e,t,n){const{fragment:s,after_update:i}=e.$$;s&&s.m(t,n),Pe(()=>{const o=e.$$.on_mount.map(Qe).filter($e);e.$$.on_destroy?e.$$.on_destroy.push(...o):Q(o),e.$$.on_mount=[]}),i.forEach(Pe)}function mt(e,t){const n=e.$$;n.fragment!==null&&(ft(n.after_update),Q(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function bt(e,t){e.$$.dirty[0]===-1&&(re.push(e),ut(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function _t(e,t,n,s,i,o,u=null,h=[-1]){const _=He;pe(e);const c=e.$$={fragment:null,ctx:[],props:o,update:he,not_equal:i,bound:je(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(_?_.$$.context:[])),callbacks:je(),dirty:h,skip_bound:!1,root:t.target||_.$$.root};u&&u(c.root);let d=!1;if(c.ctx=n?n(e,t.props||{},(g,w,...v)=>{const m=v.length?v[0]:w;return c.ctx&&i(c.ctx[g],c.ctx[g]=m)&&(!c.skip_bound&&c.bound[g]&&c.bound[g](m),d&&bt(e,g)),w}):[],c.update(),d=!0,Q(c.before_update),c.fragment=s?s(c.ctx):!1,t.target){if(t.hydrate){const g=rt(t.target);c.fragment&&c.fragment.l(g),g.forEach(W)}else c.fragment&&c.fragment.c();t.intro&&pt(e.$$.fragment),ht(e,t.target,t.anchor),et()}pe(_)}class vt{constructor(){xe(this,"$$");xe(this,"$$set")}$destroy(){mt(this,1),this.$destroy=he}$on(t,n){if(!$e(n))return he;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!st(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const wt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(wt);function Ge(e,t,n){const s=e.slice();return s[10]=t[n],s[39]=n,s}function Je(e){let t,n,s,i,o,u,h,_,c,d,g,w,v,m,z,E,B,S,q,$,ee,U,H,X,te,ue,j,ne,me,F,le,se=e[6].BrushSize+"",de,be,x,_e,K,Z,Y,ie,a,b,R,L,P,M,Me,G,ve,we=e[6].SavedCanvases+"",Re,Ne,Oe,ae,fe,ze=e[6].Accept+"",Le,Te,ge,ye=e[6].Cancel+"",Ie,Ae,qe,I=e[8].display&&!e[8].disabled&&Xe(e),A=(e[3]==e[11].DRAW||e[3]==e[11].BRUSH)&&Ze(e);function We(p,y){return p[9].length==0?yt:zt}let ke=We(e),N=ke(e);return{c(){I&&I.c(),t=k(),n=f("div"),s=f("div"),i=f("div"),o=f("canvas"),_=k(),c=f("div"),d=f("div"),g=f("div"),w=f("button"),v=O("svg"),m=O("path"),E=k(),B=f("button"),S=O("svg"),q=O("path"),ee=k(),U=f("button"),H=O("svg"),X=O("path"),ue=k(),j=f("button"),j.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6"><path fill-rule="evenodd" d="M16.5 4.478v.227a48.816 48.816 0 013.878.512.75.75 0 11-.256 1.478l-.209-.035-1.005 13.07a3 3 0 01-2.991 2.77H8.084a3 3 0 01-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 01-.256-1.478A48.567 48.567 0 017.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 013.369 0c1.603.051 2.815 1.387 2.815 2.951zm-6.136-1.452a51.196 51.196 0 013.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 00-6 0v-.113c0-.794.609-1.428 1.364-1.452zm-.355 5.945a.75.75 0 10-1.5.058l.347 9a.75.75 0 101.499-.058l-.346-9zm5.48.058a.75.75 0 10-1.498-.058l-.347 9a.75.75 0 001.5.058l.345-9z" clip-rule="evenodd"></path></svg>',ne=k(),A&&A.c(),me=k(),F=f("div"),le=f("p"),de=D(se),be=k(),x=f("input"),_e=k(),K=f("div"),Z=f("button"),Y=O("svg"),ie=O("path"),b=k(),R=f("button"),L=O("svg"),P=O("path"),Me=k(),G=f("div"),ve=f("p"),Re=D(we),Ne=k(),N.c(),Oe=k(),ae=f("div"),fe=f("button"),Le=D(ze),Te=k(),ge=f("button"),Ie=D(ye),l(o,"width",u=e[4].x),l(o,"height",h=e[4].y),l(o,"class","border-4 border-zinc-800 bg-white "),V(o,"height",(window.innerHeight>800?800:400)+"px"),V(o,"width",(window.innerHeight>800?800:400)+"px"),l(m,"d","M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z"),l(v,"xmlns","http://www.w3.org/2000/svg"),l(v,"viewBox","0 0 24 24"),l(v,"fill","currentColor"),l(v,"class","w-6 h-6"),l(w,"class",z="hover:bg-zinc-900 "+(e[3]==e[11].DRAW?"bg-zinc-900":"bg-zinc-700")+" text-zinc-50 p-3 rounded-md"),l(q,"fill","currentColor"),l(q,"d","M6 21q-1.125 0-2.225-.55T2 19q.65 0 1.325-.513T4 17q0-1.25.875-2.125T7 14q1.25 0 2.125.875T10 17q0 1.65-1.175 2.825T6 21Zm5.75-6L9 12.25l8.95-8.95q.275-.275.688-.288t.712.288l1.35 1.35q.3.3.3.7t-.3.7L11.75 15Z"),l(S,"xmlns","http://www.w3.org/2000/svg"),l(S,"width","24"),l(S,"height","24"),l(S,"viewBox","0 0 24 24"),l(B,"class",$="hover:bg-zinc-900 "+(e[3]==e[11].BRUSH?"bg-zinc-900":"bg-zinc-700")+" text-zinc-50 p-3 rounded-md"),l(X,"fill","currentColor"),l(X,"d","M12.728 12.728L8.485 8.485l-5.657 5.657l2.122 2.121a3 3 0 0 0 4.242 0l3.536-3.535zM11.284 17H14a1 1 0 0 1 0 2H3a1 1 0 0 1-.133-1.991l-1.453-1.453a2 2 0 0 1 0-2.828L12.728 1.414a2 2 0 0 1 2.828 0L19.8 5.657a2 2 0 0 1 0 2.828L11.284 17z"),l(H,"xmlns","http://www.w3.org/2000/svg"),l(H,"width","24"),l(H,"height","24"),l(H,"viewBox","-1.5 -2.5 24 24"),l(U,"class",te="hover:bg-zinc-900 "+(e[3]==e[11].RUBBER?"bg-zinc-900":"bg-zinc-700")+" text-zinc-50 p-3 rounded-md"),l(j,"class","hover:bg-red-700 bg-red-900 text-zinc-50 p-3 rounded-md"),l(g,"class","flex gap-3"),l(d,"class","flex flex-col bg-zinc-800 p-3 "),l(le,"class","text-xl"),l(x,"type","range"),l(x,"min",.1),l(x,"max",20),l(x,"step",.1),l(x,"class","range--input w-full"),l(F,"class","text-zinc-50 p-3 bg-zinc-800 rounded-md"),l(ie,"fill-rule","evenodd"),l(ie,"d","M20.25 12a.75.75 0 01-.75.75H6.31l5.47 5.47a.75.75 0 11-1.06 1.06l-6.75-6.75a.75.75 0 010-1.06l6.75-6.75a.75.75 0 111.06 1.06l-5.47 5.47H19.5a.75.75 0 01.75.75z"),l(ie,"clip-rule","evenodd"),l(Y,"xmlns","http://www.w3.org/2000/svg"),l(Y,"viewBox","0 0 24 24"),l(Y,"fill","currentColor"),l(Y,"class","w-6 h-6"),l(Z,"class",a="p-3 rounded-sm "+(e[5].length>1?"bg-green-700":"bg-green-800")+" : hover:bg-green-600 text-zinc-50"),l(P,"fill-rule","evenodd"),l(P,"d","M3.75 12a.75.75 0 01.75-.75h13.19l-5.47-5.47a.75.75 0 011.06-1.06l6.75 6.75a.75.75 0 010 1.06l-6.75 6.75a.75.75 0 11-1.06-1.06l5.47-5.47H4.5a.75.75 0 01-.75-.75z"),l(P,"clip-rule","evenodd"),l(L,"xmlns","http://www.w3.org/2000/svg"),l(L,"viewBox","0 0 24 24"),l(L,"fill","currentColor"),l(L,"class","w-6 h-6"),l(R,"class",M="p-3 rounded-sm "+(e[7].length>0?"bg-green-700":"bg-green-800")+" hover:bg-green-600 text-zinc-50"),l(K,"class","flex gap-3 bg-zinc-800 p-3"),l(ve,"class","text-zinc-50 text-xl"),l(G,"class","flex flex-col bg-zinc-800 p-3"),l(G,"style",window.innerHeight>800?"height: 100%; overflow:auto;":""),l(fe,"class","bg-zinc-700 hover:bg-zinc-600 rounded-sm text-zinc-50"),l(ge,"class","bg-zinc-700 hover:bg-zinc-600 rounded-sm text-zinc-50"),l(ae,"class","flex gap-3 flex-col bg-zinc-800 p-3 mt-auto rounded-sm"),l(c,"class","flex gap-2 flex-col bg-zinc-900 p-3 rounded-r-sm w-fit overflow-auto"),V(c,"height",(window.innerHeight>800?800:400)+"px"),l(i,"class","flex select-none "),l(s,"class","transform absolute -translate-x-1/2 left-1/2 top-1/2 -translate-y-1/2 "),l(n,"class","w-full h-full bg-zinc-900 bg-opacity-70 ")},m(p,y){I&&I.m(p,y),J(p,t,y),J(p,n,y),r(n,s),r(s,i),r(i,o),e[25](o),r(i,_),r(i,c),r(c,d),r(d,g),r(g,w),r(w,v),r(v,m),r(g,E),r(g,B),r(B,S),r(S,q),r(g,ee),r(g,U),r(U,H),r(H,X),r(g,ue),r(g,j),r(d,ne),A&&A.m(d,null),r(c,me),r(c,F),r(F,le),r(le,de),r(F,be),r(F,x),Be(x,e[2]),r(c,_e),r(c,K),r(K,Z),r(Z,Y),r(Y,ie),r(K,b),r(K,R),r(R,L),r(L,P),r(c,Me),r(c,G),r(G,ve),r(ve,Re),r(G,Ne),N.m(G,null),r(c,Oe),r(c,ae),r(ae,fe),r(fe,Le),r(ae,Te),r(ae,ge),r(ge,Ie),Ae||(qe=[C(o,"mousemove",e[15]),C(o,"mousedown",Se(e[13]),{passive:!1}),C(o,"mouseup",e[14]),C(w,"click",Se(e[26])),C(B,"click",Se(e[27])),C(U,"click",Se(e[28])),C(j,"click",e[29]),C(x,"change",e[31]),C(x,"input",e[31]),C(Z,"click",e[18]),C(R,"click",e[19]),C(fe,"click",e[20]),C(ge,"click",e[34])],Ae=!0)},p(p,y){p[8].display&&!p[8].disabled?I?I.p(p,y):(I=Xe(p),I.c(),I.m(t.parentNode,t)):I&&(I.d(1),I=null),y[0]&16&&u!==(u=p[4].x)&&l(o,"width",u),y[0]&16&&h!==(h=p[4].y)&&l(o,"height",h),y[0]&8&&z!==(z="hover:bg-zinc-900 "+(p[3]==p[11].DRAW?"bg-zinc-900":"bg-zinc-700")+" text-zinc-50 p-3 rounded-md")&&l(w,"class",z),y[0]&8&&$!==($="hover:bg-zinc-900 "+(p[3]==p[11].BRUSH?"bg-zinc-900":"bg-zinc-700")+" text-zinc-50 p-3 rounded-md")&&l(B,"class",$),y[0]&8&&te!==(te="hover:bg-zinc-900 "+(p[3]==p[11].RUBBER?"bg-zinc-900":"bg-zinc-700")+" text-zinc-50 p-3 rounded-md")&&l(U,"class",te),p[3]==p[11].DRAW||p[3]==p[11].BRUSH?A?A.p(p,y):(A=Ze(p),A.c(),A.m(d,null)):A&&(A.d(1),A=null),y[0]&64&&se!==(se=p[6].BrushSize+"")&&T(de,se),y[0]&4&&Be(x,p[2]),y[0]&32&&a!==(a="p-3 rounded-sm "+(p[5].length>1?"bg-green-700":"bg-green-800")+" : hover:bg-green-600 text-zinc-50")&&l(Z,"class",a),y[0]&128&&M!==(M="p-3 rounded-sm "+(p[7].length>0?"bg-green-700":"bg-green-800")+" hover:bg-green-600 text-zinc-50")&&l(R,"class",M),y[0]&64&&we!==(we=p[6].SavedCanvases+"")&&T(Re,we),ke===(ke=We(p))&&N?N.p(p,y):(N.d(1),N=ke(p),N&&(N.c(),N.m(G,null))),y[0]&64&&ze!==(ze=p[6].Accept+"")&&T(Le,ze),y[0]&64&&ye!==(ye=p[6].Cancel+"")&&T(Ie,ye)},d(p){p&&(W(t),W(n)),I&&I.d(p),e[25](null),A&&A.d(),N.d(),Ae=!1,Q(qe)}}}function Xe(e){let t,n,s,i=e[6].PasteImage+"",o,u,h,_,c=e[6].SaveCanvas+"",d,g,w,v;return{c(){t=f("div"),n=f("button"),s=f("p"),o=D(i),u=k(),h=f("button"),_=f("p"),d=D(c),l(n,"class","text-zinc-50 bg-zinc-800 p-2 hover:bg-zinc-700 cursor-pointer w-full"),l(n,"item","paste"),l(h,"class","text-zinc-50 bg-zinc-800 p-2 hover:bg-zinc-700 cursor-pointer w-full"),l(h,"item","save"),l(t,"class",g="absolute "+(e[8].display?"":"hidden")+" z-10 context--menu bg-zinc-800 flex flex-col border-2 border-zinc-900 rounded-sm"),V(t,"top",e[8].y+"px"),V(t,"left",e[8].x+"px")},m(m,z){J(m,t,z),r(t,n),r(n,s),r(s,o),r(t,u),r(t,h),r(h,_),r(_,d),w||(v=[C(n,"click",e[23]),C(h,"click",e[24])],w=!0)},p(m,z){z[0]&64&&i!==(i=m[6].PasteImage+"")&&T(o,i),z[0]&64&&c!==(c=m[6].SaveCanvas+"")&&T(d,c),z[0]&256&&g!==(g="absolute "+(m[8].display?"":"hidden")+" z-10 context--menu bg-zinc-800 flex flex-col border-2 border-zinc-900 rounded-sm")&&l(t,"class",g),z[0]&256&&V(t,"top",m[8].y+"px"),z[0]&256&&V(t,"left",m[8].x+"px")},d(m){m&&W(t),w=!1,Q(v)}}}function Ze(e){let t,n,s=e[6].BrushColor+"",i,o,u,h,_;return{c(){t=f("div"),n=f("p"),i=D(s),o=k(),u=f("input"),l(n,"class","text-xl"),l(u,"type","color"),l(t,"class","text-zinc-50 mt-2 bg-zinc-800 rounded-md")},m(c,d){J(c,t,d),r(t,n),r(n,i),r(t,o),r(t,u),Be(u,e[1]),h||(_=C(u,"input",e[30]),h=!0)},p(c,d){d[0]&64&&s!==(s=c[6].BrushColor+"")&&T(i,s),d[0]&2&&Be(u,c[1])},d(c){c&&W(t),h=!1,_()}}}function zt(e){let t,n=Ye(e[9]),s=[];for(let i=0;i<n.length;i+=1)s[i]=Ve(Ge(e,n,i));return{c(){t=f("div");for(let i=0;i<s.length;i+=1)s[i].c();l(t,"class","grid grid-cols-2 gap-3 cursor-pointer")},m(i,o){J(i,t,o);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(t,null)},p(i,o){if(o[0]&2294272){n=Ye(i[9]);let u;for(u=0;u<n.length;u+=1){const h=Ge(i,n,u);s[u]?s[u].p(h,o):(s[u]=Ve(h),s[u].c(),s[u].m(t,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=n.length}},d(i){i&&W(t),it(s,i)}}}function yt(e){let t,n,s=e[6].NoSavedCanvases+"",i,o,u,h=e[6].SaveCanvasItem+"",_;return{c(){t=f("div"),n=f("p"),i=D(s),o=k(),u=f("p"),_=D(h),l(n,"class","text-zinc-300"),l(u,"class","text-zinc-500 text-sm"),l(t,"class","w-full h-full m-auto flex flex-col gap-0.5")},m(c,d){J(c,t,d),r(t,n),r(n,i),r(t,o),r(t,u),r(u,_)},p(c,d){d[0]&64&&s!==(s=c[6].NoSavedCanvases+"")&&T(i,s),d[0]&64&&h!==(h=c[6].SaveCanvasItem+"")&&T(_,h)},d(c){c&&W(t)}}}function Ve(e){var E;let t,n,s,i=((E=e[10])==null?void 0:E.name)+"",o,u,h,_,c,d,g,w,v;function m(){return e[32](e[39])}function z(){return e[33](e[10])}return{c(){t=f("button"),n=f("div"),s=f("p"),o=D(i),u=k(),h=f("button"),h.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 stroke-red-900 hover:stroke-red-700"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>',_=k(),c=f("img"),g=k(),l(s,"class","text-zinc-50"),l(h,"class","justify-end ml-auto "),l(n,"class","flex items-center"),Fe(c.src,d=e[10].url)||l(c,"src",d),l(c,"class","p-2 aspect-square bg-zinc-500 rounded-sm"),l(c,"alt","?"),l(t,"class","p-2 rounded-md bg-zinc-900 transition-all")},m(B,S){J(B,t,S),r(t,n),r(n,s),r(s,o),r(n,u),r(n,h),r(t,_),r(t,c),r(t,g),w||(v=[C(h,"click",m),C(t,"click",z)],w=!0)},p(B,S){var q;e=B,S[0]&512&&i!==(i=((q=e[10])==null?void 0:q.name)+"")&&T(o,i),S[0]&512&&!Fe(c.src,d=e[10].url)&&l(c,"src",d)},d(B){B&&W(t),w=!1,Q(v)}}}function kt(e){let t,n=e[0]&&Je(e);return{c(){n&&n.c(),t=at()},m(s,i){n&&n.m(s,i),J(s,t,i)},p(s,i){s[0]?n?n.p(s,i):(n=Je(s),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:he,o:he,d(s){s&&W(t),n&&n.d(s)}}}function Ct(e,t){const n=document.createElement("canvas"),s=n.getContext("2d");var i=new Image;i.crossOrigin="anonymous",i.src=e,i.onload=function(){n.width=i.width,n.height=i.height,s==null||s.drawImage(i,0,0),t(n.toDataURL("image/png")),n.remove()},i.onerror=()=>{t(null)}}function St(e,t,n){var s=(a=>(a[a.DRAW=0]="DRAW",a[a.BRUSH=1]="BRUSH",a[a.RUBBER=2]="RUBBER",a))(s||{});let i=!1,o,u="#000",h=!1,_=1,c=0,d={x:400,y:400},g=[new ImageData(d.x,d.y)],w={BrushSize:"Size",BrushColor:"Color",SavedCanvases:"Saved",Accept:"Accept",Cancel:"Cancel",Forward:"Forward",Backward:"Backward",LeftArrow:"Left",RightArrow:"Right",UpArrow:"Up",DownArrow:"Down",SaveCanvas:"Save Canvas",PasteImage:"Paste Image",NoSavedCanvases:"Brak zapisanych rysunków",SaveCanvasItem:"Naciśnij PPM aby zapisac rysunek"},v=[],m={display:!1,x:0,y:0,disabled:!1},z=(a,b)=>{fetch(`https://${window.GetParentResourceName()}/${a}`,{body:JSON.stringify(b),method:"POST"}).catch(()=>{})},E=JSON.parse(localStorage.getItem("hs-painter:savedCanvases")??"[]")??[];const B=a=>{var b;if(a.buttons==1){h=!0,n(8,m.display=!1,m),n(8,m),(b=o.getContext("2d"))==null||b.beginPath();return}a.buttons==2&&!m.disabled&&(n(8,m.x=a.clientX,m),n(8,m.y=a.clientY,m),n(8,m.display=!0,m),n(8,m),h=!1)},S=()=>{var b;let a=(b=o.getContext("2d"))==null?void 0:b.getImageData(0,0,o.width,o.height);a&&(g.push(a),n(7,v=[]))},q=a=>{h=!1,S()},$=a=>{if(!o)return;let b=o.getContext("2d");if(!b||!h)return;let R=o.getBoundingClientRect(),L=5*_,P=a.pageX-R.left,M=a.pageY-R.top;if(P*=d.y/R.height,M*=d.y/R.height,P-=L*.5,M-=L*.5,c==2){b.clearRect(P,M,L,L);return}b.strokeStyle=u,b.fillStyle=u,c==0?(b.lineWidth=L,b.lineTo(P,M),b.stroke()):c==1&&(b.beginPath(),b.arc(P,M,L,0,360),b.closePath(),b.fill())},ee=a=>{let b=new Image;b.src=a,b.onload=()=>{var R;(R=o.getContext("2d"))==null||R.drawImage(b,0,0,o.width,o.height),S()},n(8,m.display=!1,m),n(8,m)},U=()=>{var a;n(7,v=[]),n(5,g=[new ImageData(o.width,o.height)]),(a=o.getContext("2d"))==null||a.clearRect(0,0,o.width,o.height)},H=()=>{var b;v.push(g.pop());let a=g[g.length-1];a&&((b=o.getContext("2d"))==null||b.putImageData(a,0,0))},X=()=>{var b;g.push(v.pop());let a=g[g.length-1];a&&((b=o.getContext("2d"))==null||b.putImageData(a,0,0))},te=()=>{const a=o.toDataURL("png",.92);z("ItemAccept",{url:a}),U(),n(0,i=!1)},ue=()=>{n(9,E),window.localStorage.setItem("hs-painter:savedCanvases",JSON.stringify(E))};window.addEventListener("contextmenu",function(a){a.preventDefault()}),window.addEventListener("keypress",a=>{a.ctrlKey&&a.code=="KeyZ"&&g.length>1?H():a.ctrlKey&&a.code=="KeyY"&&v.length>0&&X()}),window.addEventListener("message",a=>{a.data.type=="SetPaintDisplay"?n(0,i=a.data.display):a.data.type=="OnContextMenuCallback"?a.data.item=="paste"?ee(a.data.url):a.data.item=="save"&&(E.push({name:a.data.name,url:o.toDataURL("png",1)}),ue()):a.data.type=="LoadUIConfig"?(n(6,w=a.data.locales),n(8,m.disabled=a.data.contextMenuDisabled,m)):a.data.type=="SetTargetSize"?(n(4,d.x=a.data.sizeX,d),n(4,d.y=a.data.sizeY,d),n(4,d)):a.data.type=="GetBase64URLFromImage"&&Ct(a.data.url,b=>{z("LoadGameTexture",{id:a.data.id,texture:b})})});const j=a=>{E.splice(a,1),ue()},ne=a=>{z("OnContextMenu",{item:a})},me=()=>{ne("paste")},F=()=>{ne("save")};function le(a){Ee[a?"unshift":"push"](()=>{o=a,n(10,o)})}const se=()=>{n(3,c=s.DRAW)},de=()=>{n(3,c=s.BRUSH)},be=()=>{n(3,c=s.RUBBER)},x=()=>U();function _e(){u=this.value,n(1,u)}function K(){_=ot(this.value),n(2,_)}return[i,u,_,c,d,g,w,v,m,E,o,s,z,B,q,$,ee,U,H,X,te,j,ne,me,F,le,se,de,be,x,_e,K,a=>j(a),a=>{U(),ee(a==null?void 0:a.url)},()=>{z("Cancel",{})}]}class Bt extends vt{constructor(t){super(),_t(this,t,St,kt,lt,{},null,[-1,-1])}}new Bt({target:document.getElementById("app")});
